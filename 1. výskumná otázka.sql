--1. Rostou v průběhu let mzdy ve všech odvětvích, nebo v některých klesají?

WITH TEMP_BASE AS
(
SELECT 
	year, 
	avg_value, 
	industry_name
FROM t_dana_lancaricova_project_sql_primary_final
WHERE 
	category = 'SALARY'
),

industry_salary AS
(
SELECT TEMP_BASE__2000.industry_name,
TEMP_BASE__2000.AVG_VALUE AS AVG_2000,
TEMP_BASE__2001.AVG_VALUE AS AVG_2001,
TEMP_BASE__2002.AVG_VALUE AS AVG_2002,
TEMP_BASE__2003.AVG_VALUE AS AVG_2003,
TEMP_BASE__2004.AVG_VALUE AS AVG_2004,
TEMP_BASE__2005.AVG_VALUE AS AVG_2005,
TEMP_BASE__2006.AVG_VALUE AS AVG_2006,
TEMP_BASE__2007.AVG_VALUE AS AVG_2007,
TEMP_BASE__2008.AVG_VALUE AS AVG_2008,
TEMP_BASE__2009.AVG_VALUE AS AVG_2009,
TEMP_BASE__2010.AVG_VALUE AS AVG_2010,
TEMP_BASE__2011.AVG_VALUE AS AVG_2011,
TEMP_BASE__2012.AVG_VALUE AS AVG_2012,
TEMP_BASE__2013.AVG_VALUE AS AVG_2013,
TEMP_BASE__2014.AVG_VALUE AS AVG_2014,
TEMP_BASE__2015.AVG_VALUE AS AVG_2015,
TEMP_BASE__2016.AVG_VALUE AS AVG_2016,
TEMP_BASE__2017.AVG_VALUE AS AVG_2017,
TEMP_BASE__2018.AVG_VALUE AS AVG_2018,
TEMP_BASE__2019.AVG_VALUE AS AVG_2019,
TEMP_BASE__2020.AVG_VALUE AS AVG_2020,
TEMP_BASE__2021.AVG_VALUE AS AVG_2021
FROM TEMP_BASE   TEMP_BASE__2000
INNER JOIN TEMP_BASE   TEMP_BASE__2001
	ON TEMP_BASE__2001.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2001.year = '2001'
INNER JOIN TEMP_BASE   TEMP_BASE__2002
	ON TEMP_BASE__2002.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2002.year = '2002'
INNER JOIN TEMP_BASE   TEMP_BASE__2003
	ON TEMP_BASE__2003.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2003.year = '2003'
INNER JOIN TEMP_BASE   TEMP_BASE__2004
	ON TEMP_BASE__2004.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2004.year = '2004'
INNER JOIN TEMP_BASE   TEMP_BASE__2005
	ON TEMP_BASE__2005.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2005.year = '2005'
INNER JOIN TEMP_BASE   TEMP_BASE__2006
	ON TEMP_BASE__2006.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2006.year = '2006'
INNER JOIN TEMP_BASE   TEMP_BASE__2007
	ON TEMP_BASE__2007.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2007.year = '2007'
INNER JOIN TEMP_BASE   TEMP_BASE__2008
	ON TEMP_BASE__2008.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2008.year = '2008'
INNER JOIN TEMP_BASE   TEMP_BASE__2009
	ON TEMP_BASE__2009.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2009.year = '2009'
INNER JOIN TEMP_BASE   TEMP_BASE__2010
	ON TEMP_BASE__2010.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2010.year = '2010'
INNER JOIN TEMP_BASE   TEMP_BASE__2011
	ON TEMP_BASE__2011.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2011.year = '2011'
INNER JOIN TEMP_BASE   TEMP_BASE__2012
	ON TEMP_BASE__2012.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2012.year = '2012'
INNER JOIN TEMP_BASE   TEMP_BASE__2013
	ON TEMP_BASE__2013.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2013.year = '2013'
INNER JOIN TEMP_BASE   TEMP_BASE__2014
	ON TEMP_BASE__2014.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2014.year = '2014'
INNER JOIN TEMP_BASE   TEMP_BASE__2015
	ON TEMP_BASE__2015.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2015.year = '2015'
INNER JOIN TEMP_BASE   TEMP_BASE__2016
	ON TEMP_BASE__2016.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2016.year = '2016'
INNER JOIN TEMP_BASE   TEMP_BASE__2017
	ON TEMP_BASE__2017.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2017.year = '2017'
INNER JOIN TEMP_BASE   TEMP_BASE__2018
	ON TEMP_BASE__2018.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2018.year = '2018'
INNER JOIN TEMP_BASE   TEMP_BASE__2019
	ON TEMP_BASE__2019.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2019.year = '2019'
INNER JOIN TEMP_BASE   TEMP_BASE__2020
	ON TEMP_BASE__2020.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2020.year = '2020'
INNER JOIN TEMP_BASE   TEMP_BASE__2021
	ON TEMP_BASE__2021.INDUSTRY_NAME = TEMP_BASE__2000.INDUSTRY_NAME
	AND TEMP_BASE__2021.year = '2021'
WHERE TEMP_BASE__2000.year = '2000'
)

SELECT industry_name, 
CASE WHEN AVG_2000 < AVG_2001
	AND AVG_2001 < AVG_2002
	AND AVG_2002 < AVG_2003
	AND AVG_2003 < AVG_2004
	AND AVG_2004 < AVG_2005
	AND AVG_2005 < AVG_2006
	AND AVG_2006 < AVG_2007
	AND AVG_2007 < AVG_2008
	AND AVG_2008 < AVG_2009
	AND AVG_2009 < AVG_2010
	AND AVG_2010 < AVG_2011
	AND AVG_2011 < AVG_2012
	AND AVG_2012 < AVG_2013
	AND AVG_2013 < AVG_2014
	AND AVG_2014 < AVG_2015
	AND AVG_2015 < AVG_2016
	AND AVG_2016 < AVG_2017
	AND AVG_2017 < AVG_2018
	AND AVG_2018 < AVG_2019
	AND AVG_2019 < AVG_2020
	AND AVG_2020 < AVG_2021
THEN 'kazdorocny rast'
ELSE 'aspon jeden pokles'
END RESULT
FROM industry_salary;
